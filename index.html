<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <title>Application Form</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="format-detection" content="telephone=no">
  
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.1/font/bootstrap-icons.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="main-container">
    <div class="form-card">
      <div class="header-section">
        <div class="icon-badge">
          <i class="bi bi-person-fill-add"></i>
        </div>
        <h1 class="form-title">Application Form</h1>
        <p class="form-subtitle">Join our team - Fill out all required fields to submit your application</p>
      </div>
      
      <form id="applicationForm" action="https://script.google.com/macros/s/AKfycbwyaSKtBsNWYHn-Ph3sVmdyCT1cIe4aULvmCFfoLhmyArtl1VIHyu4xRgKSFrpuft4aDQ/exec" method="post" novalidate>
        <div class="form-section">
          <h3 class="section-title">
            <i class="bi bi-person-circle me-2"></i>
            Personal Information
          </h3>
          <div class="row g-4">
            <div class="col-md-4">
              <label for="name" class="form-label">
                <i class="bi bi-person"></i>
                Full Name<span class="required-asterisk">*</span>
              </label>
              <input type="text" class="form-control" id="name" name="name" required 
                     autocomplete="name" placeholder="Enter your full name">
              <div class="invalid-feedback">Please provide your full name.</div>
              <div class="valid-feedback">Looks good!</div>
            </div>
            
            <div class="col-md-4">
              <label for="mobile" class="form-label">
                <i class="bi bi-phone"></i>
                Mobile Number<span class="required-asterisk">*</span>
              </label>
              <div class="input-group">
                <span class="input-group-text">+91</span>
                <input type="tel" class="form-control" id="mobile" name="mobile" required 
                       autocomplete="tel" placeholder="10 digit number" maxlength="10" pattern="[0-9]{10}">
              </div>
              <div class="invalid-feedback">Please provide a valid 10-digit mobile number.</div>
              <div class="valid-feedback">Mobile number is valid!</div>
            </div>
            
            <div class="col-md-4">
              <label for="email" class="form-label">
                <i class="bi bi-envelope"></i>
                Email Address<span class="required-asterisk">*</span>
              </label>
              <input type="email" class="form-control" id="email" name="email" required 
                     autocomplete="email" placeholder="user@example.com">
              <div class="invalid-feedback">Please provide a valid email address.</div>
              <div class="valid-feedback">Email looks great!</div>
            </div>

            <div class="col-md-4">
              <label for="dob" class="form-label">
                <i class="bi bi-calendar"></i>
                Date of Birth<span class="required-asterisk">*</span>
              </label>
              <input type="date" class="form-control" id="dob" name="dob" required autocomplete="bday">
              <div class="invalid-feedback">Please select your date of birth.</div>
              <div class="valid-feedback">Date of birth confirmed!</div>
            </div>
            
            <div class="col-md-4">
              <label for="gender" class="form-label">
                <i class="bi bi-person-badge"></i>
                Gender<span class="required-asterisk">*</span>
              </label>
              <select class="form-select" id="gender" name="gender" required autocomplete="sex">
                <option value="">Select Gender</option>
                <option value="Male">Male</option>
                <option value="Female">Female</option>
                <option value="Other">Other</option>
              </select>
              <div class="invalid-feedback">Please select your gender.</div>
              <div class="valid-feedback">Gender selected!</div>
            </div>
          </div>
        </div>

        <div class="form-section">
          <h3 class="section-title">
            <i class="bi bi-house-door me-2"></i>
            Address Details
          </h3>
          <div class="row g-4">
            <div class="col-md-4">
              <label for="state" class="form-label">
                <i class="bi bi-geo-alt"></i>
                State<span class="required-asterisk">*</span>
              </label>
              <select class="form-select" id="state" name="state" required autocomplete="address-level1">
                <option value="">Select State</option>
              </select>
              <div class="invalid-feedback">Please select your state.</div>
              <div class="valid-feedback">State selected!</div>
            </div>

            <div class="col-md-4">
              <label for="city" class="form-label">
                <i class="bi bi-buildings"></i>
                City<span class="required-asterisk">*</span>
              </label>
              <input type="text" class="form-control" id="city" name="city" required 
                     autocomplete="address-level2" placeholder="Enter your city">
              <div class="invalid-feedback">Please enter your city.</div>
              <div class="valid-feedback">City looks good!</div>
            </div>

            <div class="col-md-4">
              <label for="street" class="form-label">
                <i class="bi bi-signpost-2"></i>
                Street
              </label>
              <input type="text" class="form-control" id="street" name="street" 
                     autocomplete="street-address" placeholder="Enter your street address">
            </div>

            <div class="col-md-4">
              <label for="pincode" class="form-label">
                <i class="bi bi-pin"></i>
                Pin Code<span class="required-asterisk">*</span>
              </label>
              <input type="text" class="form-control" id="pincode" name="pincode" required 
                     autocomplete="postal-code" placeholder="Enter your pincode" maxlength="6" pattern="[0-9]{6}">
              <div class="invalid-feedback">Please provide a valid 6-digit pincode.</div>
              <div class="valid-feedback">Pincode looks good!</div>
            </div>
          </div>
        </div>
        
        <div class="form-section">
          <h3 class="section-title">
            <i class="bi bi-mortarboard me-2"></i>
            Educational Details
          </h3>
          <div class="row g-4">
            <div class="col-md-4">
              <label for="university" class="form-label">
                <i class="bi bi-building"></i>
                University/College/School Name<span class="required-asterisk">*</span>
              </label>
              <input type="text" class="form-control" id="university" name="university" required 
                     autocomplete="organization" placeholder="e.g., ABC University">
              <div class="invalid-feedback">Please provide your institution name.</div>
              <div class="valid-feedback">Looks good!</div>
            </div>

            <div class="col-md-4">
              <label for="course" class="form-label">
                <i class="bi bi-journal-text"></i>
                Course/Subject Name<span class="required-asterisk">*</span>
              </label>
              <input type="text" class="form-control" id="course" name="course" required 
                     autocomplete="off" placeholder="e.g., Computer Science">
              <div class="invalid-feedback">Please provide your course name.</div>
              <div class="valid-feedback">Looks good!</div>
            </div>

            <div class="col-md-4">
              <label for="graduation" class="form-label">
                <i class="bi bi-award"></i>
                Education Level<span class="required-asterisk">*</span>
              </label>
              <select class="form-select" id="graduation" name="graduation" required autocomplete="education">
                <option value="">Select Education Level</option>
                <option value="10th Pass out">10th Pass</option>
                <option value="Intermediate">12th/Intermediate</option>
                <option value="Degree">Graduate Degree</option>
                <option value="Post Graduate">Post Graduate</option>
              </select>
              <div class="invalid-feedback">Please select your education level.</div>
              <div class="valid-feedback">Education level confirmed!</div>
            </div>
          </div>
        </div>
        
        <div class="form-section">
          <h3 class="section-title">
            <i class="bi bi-briefcase me-2"></i>
            Internship Details
          </h3>
          <div class="row g-4">
            <div class="col-md-4">
              <label for="applyingFor" class="form-label">
                <i class="bi bi-briefcase"></i>
                Position Applied For<span class="required-asterisk">*</span>
              </label>
              <select class="form-select" id="applyingFor" name="applyingFor" required>
                <option value="">Select Position</option>
                <option value="HR">Human Resources (HR)</option>
                <option value="CCE">Customer Care Executive (CCE)</option>
                <option value="Admin">Administration</option>
                <option value="TL">Team Leader (TL)</option>
                <option value="Manager">Manager</option>
              </select>
              <div class="invalid-feedback">Please select the position you're applying for.</div>
              <div class="valid-feedback">Position selected!</div>
            </div>
            
            <div class="col-md-4">
              <label for="domain" class="form-label">
                <i class="bi bi-lightbulb"></i>
                Domain<span class="required-asterisk">*</span>
              </label>
              <select class="form-select" id="domain" name="domain" required>
                <option value="">Select Domain</option>
                <option value="Sales">Sales</option>
                <option value="HR">HR</option>
                <option value="Finance">Finance</option>
                <option value="Graphic Designing">Graphic Designing</option>
                <option value="Video Editing">Video Editing</option>
                <option value="Content Writing">Content Writing</option>
              </select>
              <div class="invalid-feedback">Please select a domain.</div>
              <div class="valid-feedback">Domain selected!</div>
            </div>
            
            <div class="col-md-4">
              <label for="duration" class="form-label">
                <i class="bi bi-clock-history"></i>
                Duration<span class="required-asterisk">*</span>
              </label>
              <select class="form-select" id="duration" name="duration" required>
                <option value="">Select Duration</option>
                <option value="3 Months">3 Months</option>
                <option value="4 Months">4 Months</option>
                <option value="6 Months">6 Months</option>
              </select>
              <div class="invalid-feedback">Please select a duration.</div>
              <div class="valid-feedback">Duration selected!</div>
            </div>

            <div class="col-md-4">
              <label for="contactMethod" class="form-label">
                <i class="bi bi-chat-dots"></i>
                Preferred Contact Method<span class="required-asterisk">*</span>
              </label>
              <select class="form-select" id="contactMethod" name="contactMethod" required>
                <option value="">Select Contact Method</option>
                <option value="Phone">Phone Call</option>
                <option value="WhatsApp or Email">WhatsApp or Email</option>
                <option value="Both">Both (Phone & Digital)</option>
              </select>
              <div class="invalid-feedback">Please select your preferred contact method.</div>
              <div class="valid-feedback">Contact method selected!</div>
            </div>
            
            <div class="col-md-4">
              <label for="tpoName" class="form-label">
                <i class="bi bi-person-badge"></i>
                TPO Name
              </label>
              <input type="text" class="form-control" id="tpoName" name="tpoName" 
                     autocomplete="off" placeholder="TPO's full name">
            </div>

            <div class="col-md-4">
              <label for="tpoMobile" class="form-label">
                <i class="bi bi-phone"></i>
                TPO Contact Number
              </label>
              <input type="tel" class="form-control" id="tpoMobile" name="tpoMobile" 
                     autocomplete="off" placeholder="TPO's 10-digit number" maxlength="10" pattern="[0-9]{10}">
            </div>

            <div class="col-md-4">
              <label for="tpoEmail" class="form-label">
                <i class="bi bi-envelope"></i>
                TPO Email
              </label>
              <input type="email" class="form-control" id="tpoEmail" name="tpoEmail" 
                     autocomplete="off" placeholder="tpo@example.com">
            </div>

            <div class="col-md-8">
              <label for="resume" class="form-label">
                <i class="bi bi-file-earmark-arrow-up"></i>
                Upload CV/Resume<span class="required-asterisk">*</span>
              </label>
              <input class="form-control" type="file" id="resume" name="resume" required>
              <div class="invalid-feedback">Please upload your CV/Resume.</div>
              <div class="valid-feedback">File selected!</div>
            </div>

          </div>
        </div>

        <div class="form-section">
          <h3 class="section-title">
            <i class="bi bi-clipboard-check me-2"></i>
            Previous Internship Experience
          </h3>
          <div class="row g-4">
            <div class="col-12">
              <label class="form-label">Any previous internship experience?</label>
              <div class="d-flex gap-4">
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="previousExperience" id="expYes" value="Yes">
                  <label class="form-check-label" for="expYes">Yes</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="previousExperience" id="expNo" value="No" checked>
                  <label class="form-check-label" for="expNo">No</label>
                </div>
              </div>
            </div>
            <div class="col-12" id="previousExpDetails" style="display:none;">
              <label for="expDescription" class="form-label">
                <i class="bi bi-pencil-square"></i>
                Briefly describe your responsibilities and tasks during the internship.
              </label>
              <textarea class="form-control" id="expDescription" name="expDescription" rows="4"></textarea>
            </div>
          </div>
        </div>
        
        <div class="row mt-5">
          <div class="col-12 text-center">
            <button type="submit" class="btn btn-primary btn-lg" id="submitBtn">
              <i class="bi bi-send me-2"></i>
              Submit Application
            </button>
          </div>
        </div>
      </form>
      
      <div id="messageDiv"></div>
    </div>
  </div>

  <script src="https://script.google.com/macros/s/AKfycby1A8Kf726Ky3nJ0vz06bMAEnjlnu5ddjCrzrowTprgwTWLPSO-2RcI5o8DA7jXkkZ_/exec"></script>
  
  <script>
    const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
    
    // Global function to display a message to the user
    function showMessage(message, type) {
        const messageDiv = document.getElementById('messageDiv');
        const alertHtml = `
            <div class="alert alert-${type} alert-dismissible fade show" role="alert">
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        `;
        messageDiv.innerHTML = alertHtml;
        messageDiv.scrollIntoView({ behavior: 'smooth' });
    }

    // This function simulates fetching Indian states. In a real-world Google Apps Script project,
    // you would have a corresponding function named `getIndianStates()` in your `Code.gs` file.
    function getIndianStates() {
        // This is mock data for the example.
        return ["Andhra Pradesh", "Arunachal Pradesh", "Assam", "Bihar", "Chhattisgarh", "Goa", "Gujarat", "Haryana", "Himachal Pradesh", "Jharkhand", "Karnataka", "Kerala", "Madhya Pradesh", "Maharashtra", "Manipur", "Meghalaya", "Mizoram", "Nagaland", "Odisha", "Punjab", "Rajasthan", "Sikkim", "Tamil Nadu", "Telangana", "Tripura", "Uttar Pradesh", "Uttarakhand", "West Bengal"];
    }

    // Set up the form and its elements after the page has fully loaded
    window.onload = function() {
      const stateDropdown = document.getElementById('state');
      
      const loadingOption = document.createElement('option');
      loadingOption.textContent = "Loading states...";
      loadingOption.disabled = true;
      stateDropdown.appendChild(loadingOption);
      
      // We will simulate the google.script.run call with our mock function for demonstration purposes.
      // If this were a real Apps Script project, this would be uncommented:
      /*
      google.script.run.withSuccessHandler(function(states) {
        stateDropdown.innerHTML = '<option value="">Select State</option>';
        if (states && states.length > 0) {
          states.forEach(function(stateName) {
            const option = document.createElement('option');
            option.value = stateName;
            option.textContent = stateName;
            stateDropdown.appendChild(option);
          });
        }
      }).withFailureHandler(function(error) {
        console.error("Error fetching states: " + error.message);
        stateDropdown.innerHTML = '<option value="">Error loading states</option>';
      }).getIndianStates();
      */

      // Using the mock function for this standalone HTML file
      const states = getIndianStates();
      stateDropdown.innerHTML = '<option value="">Select State</option>';
      if (states && states.length > 0) {
          states.forEach(function(stateName) {
              const option = document.createElement('option');
              option.value = stateName;
              option.textContent = stateName;
              stateDropdown.appendChild(option);
          });
      }

      // Add mobile-specific user experience enhancements
      if (isMobile) {
        const inputs = document.querySelectorAll('input, select');
        inputs.forEach(input => {
          // This prevents zoom-in on mobile when tapping on inputs
          input.addEventListener('focus', function() {
            this.style.fontSize = '16px';
          });
        });
        
        // Add subtle haptic feedback for mobile users
        if ('vibrate' in navigator) {
          document.getElementById('submitBtn').addEventListener('click', function() {
            navigator.vibrate(50);
          });
        }
      }
    };

    const form = document.getElementById('applicationForm');
    const submitButton = document.getElementById('submitBtn');
    const messageDiv = document.getElementById('messageDiv');
    const expYes = document.getElementById('expYes');
    const expNo = document.getElementById('expNo');
    const previousExpDetails = document.getElementById('previousExpDetails');

    // Show/hide experience description based on radio button selection
    expYes.addEventListener('change', () => {
        previousExpDetails.style.display = 'block';
        document.getElementById('expDescription').required = true;
    });
    expNo.addEventListener('change', () => {
        previousExpDetails.style.display = 'none';
        document.getElementById('expDescription').required = false;
        document.getElementById('expDescription').value = '';
    });

    // Event listeners to restrict mobile and pincode inputs to numbers only and a specific length
    document.getElementById('mobile').addEventListener('input', function(e) {
      this.value = this.value.replace(/[^0-9]/g, '').slice(0, 10);
    });
    
    document.getElementById('pincode').addEventListener('input', function(e) {
      this.value = this.value.replace(/[^0-9]/g, '').slice(0, 6);
    });

    document.getElementById('tpoMobile').addEventListener('input', function(e) {
      this.value = this.value.replace(/[^0-9]/g, '').slice(0, 10);
    });
    
    document.getElementById('tpoEmail').addEventListener('input', function(e) {
        this.value = this.value.trim();
    });

    // Add a listener to validate fields on blur for better user experience
    const inputs = document.querySelectorAll('input, select, textarea');
    inputs.forEach(input => {
      input.addEventListener('blur', function() {
        validateField(this);
      });
    });

    /**
     * Helper function to validate a single field and apply Bootstrap classes.
     * @param {HTMLElement} input The input element to validate.
     * @returns {boolean} True if the input is valid, false otherwise.
     */
    function validateField(input) {
      // Find the closest parent that contains both the input and its feedback divs
      const parentGroup = input.closest('.form-group, .col-md-4, .col-md-8, .col-12');
      if (!input.checkValidity()) {
        input.classList.add('is-invalid');
        input.classList.remove('is-valid');
        if (parentGroup) {
          parentGroup.classList.remove('was-validated'); // Prevent this parent from getting the was-validated class
        }
        return false;
      } else {
        input.classList.add('is-valid');
        input.classList.remove('is-invalid');
        return true;
      }
    }

    form.addEventListener('submit', function(e) {
      e.preventDefault();
      
      // First, check if the form is valid using the browser's built-in check
      if (!form.checkValidity()) {
        e.stopPropagation();
        form.classList.add('was-validated'); // Add class to show all validation feedback
        
        // Find the first invalid element and scroll to it
        const firstInvalid = form.querySelector(':invalid');
        if (firstInvalid) {
          firstInvalid.focus();
          firstInvalid.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
        
        showMessage('Please complete all required fields correctly.', 'danger');
        return;
      }
      
      // If the form is valid, proceed with submission
      form.classList.add('was-validated');
      submitButton.disabled = true;
      submitButton.innerHTML = '<span class="spinner-border spinner-border-sm" role="status"></span>Submitting...';
      
      // Create and show a loading overlay
      const loadingOverlay = document.createElement('div');
      loadingOverlay.classList.add('loading-overlay');
      loadingOverlay.innerHTML = '<div class="loading-spinner"></div>';
      form.closest('.form-card').appendChild(loadingOverlay);
      
      // Create a FormData object from the form
      const formData = new FormData(form);
      
      // Note: In a real Google Apps Script project, you would uncomment the following lines
      // and have a corresponding `processForm` function in your `Code.gs` file.
      // For this example, we will simulate a successful submission.
      /*
      google.script.run
        .withSuccessHandler(function(response) {
          if (response.success) {
            showMessage('Application submitted successfully! We will contact you shortly.', 'success');
            form.reset();
            form.classList.remove('was-validated');
            // Remove 'is-valid' class from all inputs after reset
            inputs.forEach(input => input.classList.remove('is-valid'));
          } else {
            showMessage(response.message || 'An error occurred. Please try again.', 'danger');
          }
        })
        .withFailureHandler(function(error) {
          console.error("Submission failed:", error);
          showMessage('An error occurred. Please try again later.', 'danger');
        })
        .processForm(formData);
      */
      
      // Simulate success for this standalone example
      setTimeout(() => {
        showMessage('Application submitted successfully! We will contact you shortly.', 'success');
        form.reset();
        form.classList.remove('was-validated');
        // Manually remove is-valid classes
        inputs.forEach(input => {
            input.classList.remove('is-valid', 'is-invalid');
        });
        
        // Hide the loading overlay and re-enable the button
        loadingOverlay.remove();
        submitButton.disabled = false;
        submitButton.innerHTML = '<i class="bi bi-send me-2"></i>Submit Application';
      }, 2000); // Simulate a 2-second server response time
    });
  </script>
</body>

</html>
